<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>State Machine Design Pattern in Modern C++ | Dr. Vladimir Petukhov</title>
    <meta name="description" content="A portfolio site as a general C++/Python programmer, general algorithms developer, industrial computer vision engineer, machine learning engineer and web apps developer.">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-6HX7S00F14"></script>
  <script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-6HX7S00F14');</script>
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.3c7c2e09.css" as="style"><link rel="preload" href="/assets/js/app.180eebd7.js" as="script"><link rel="preload" href="/assets/js/7.5b9dc384.js" as="script"><link rel="prefetch" href="/assets/js/10.9e246527.js"><link rel="prefetch" href="/assets/js/11.f093e171.js"><link rel="prefetch" href="/assets/js/12.e9b7f08a.js"><link rel="prefetch" href="/assets/js/13.fa47007a.js"><link rel="prefetch" href="/assets/js/14.60cf40c7.js"><link rel="prefetch" href="/assets/js/15.d2c3c64d.js"><link rel="prefetch" href="/assets/js/16.4a30f428.js"><link rel="prefetch" href="/assets/js/17.51aec36c.js"><link rel="prefetch" href="/assets/js/2.a873dd49.js"><link rel="prefetch" href="/assets/js/3.589839d9.js"><link rel="prefetch" href="/assets/js/4.f4ac6c29.js"><link rel="prefetch" href="/assets/js/5.91d9c5dd.js"><link rel="prefetch" href="/assets/js/6.0c9cba5d.js"><link rel="prefetch" href="/assets/js/8.1b2dc3df.js"><link rel="prefetch" href="/assets/js/9.34bd3a85.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3c7c2e09.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Dr. Vladimir Petukhov</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Services/" class="nav-link">Services</a></div><div class="nav-item"><a href="/Contact/" class="nav-link">Contact Information</a></div><div class="nav-item"><a href="/Resume/" class="nav-link">CV</a></div><div class="nav-item"><a href="/Blog/" class="nav-link router-link-active">Blog</a></div><div class="nav-item"><a href="https://github.com/vperepos" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Services/" class="nav-link">Services</a></div><div class="nav-item"><a href="/Contact/" class="nav-link">Contact Information</a></div><div class="nav-item"><a href="/Resume/" class="nav-link">CV</a></div><div class="nav-item"><a href="/Blog/" class="nav-link router-link-active">Blog</a></div><div class="nav-item"><a href="https://github.com/vperepos" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>State Machine Design Pattern in Modern C++</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Blog/state-machine-design-pattern.html#motivation" class="sidebar-link">Motivation</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/Blog/state-machine-design-pattern.html#classes-structure-and-functionality" class="sidebar-link">Classes structure and functionality</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="state-machine-design-pattern-in-modern-c"><a href="#state-machine-design-pattern-in-modern-c" class="header-anchor">#</a> State machine design pattern in modern C++</h1> <p><a href="https://github.com/VPERepos/StateMachineDesignPattern/tree/master" target="_blank" rel="noopener noreferrer">Code on Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="motivation"><a href="#motivation" class="header-anchor">#</a> Motivation</h2> <p>Working several years as a firmware developer for FPGA-systems, where the whole business logic must be  implemented in the form of a state machine, I really got used to them and found it later on very practical also for C++ programming. A lot of algorithms, like for example text parsing, have this kind of non-linear flow with transitions and abortions, where the state machines are, may be, the best design choice. I adopted the idea of the class polymorphism (underlying in almost all design patterns, except for singleton as to my knowledge) to a state machine and implemented it in terms of the modern C++. This kind of software design was also applied for my real life programming problems, like non-XML text protocol parser.</p> <h2 id="classes-structure-and-functionality"><a href="#classes-structure-and-functionality" class="header-anchor">#</a> Classes structure and functionality</h2> <p><img src="/assets/img/ClassDiagramSTM.a5a0f7e8.svg" alt="UMLDiagram"></p> <p>UML-diagram above represents the design of the example program. There is a class called StateMachine, which consists of shared pointers to the objects of the classes Data, Status and State1 to State4. The shared pointers of types Status and Data are passed by parameters of the constructor of the StateMachine class. The objects of State1 to State4 types are allocated on heap in this constructor. Objects of types Data, Status and StateMachine are allocated on heap in the main function. Transitions of the state machine, made possible by derivation from the base class State, are implemented in the function runSTM(). They are dependent on the results of the business logic of each state, but there is only one main loop, which runs until exit is initiated. In common, the states can be filled with custom business logic, but in this example a random number is generated, which represents the next state and main loop executes the next state in the next iteration. The execution stops ordinary in the 4-th state and with an error during transition from the 3-rd to the 4-th state. It is implemented this way only in order to show the principle. Generally, as mentioned above, this design can be configured to work in any way, depending on needs.</p> <p>The principle programe flow is described by the following sequence diagram.</p> <p><img src="/assets/img/SequenceDiagramSTM.00feea42.svg" alt="UMLDiagram"></p></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.180eebd7.js" defer></script><script src="/assets/js/7.5b9dc384.js" defer></script>
  </body>
</html>
