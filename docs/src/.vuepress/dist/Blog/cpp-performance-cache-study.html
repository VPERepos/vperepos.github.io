<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.26" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const useChoice = localStorage.getItem('vuepress-color-scheme')
      const systemStatus =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (useChoice === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (useChoice === 'dark' || systemStatus) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"C++ Performance Study — Using CPU Cache Properties","image":[""],"dateModified":"2025-12-31T17:27:39.000Z","author":[{"@type":"Person","name":"Dr. Vladimir Petukhov"}]}</script><meta property="og:url" content="https://vperepos.github.io/Blog/cpp-performance-cache-study.html"><meta property="og:site_name" content="Dr. Vladimir Petukhov"><meta property="og:title" content="C++ Performance Study — Using CPU Cache Properties"><meta property="og:description" content="C++ Performance Study: Use CPU Cache Properties Code on Github Introduction While learning how to work with images for computer vision, I was told to use a property of CPU cache..."><meta property="og:type" content="article"><meta property="og:locale" content="en-US"><meta property="og:updated_time" content="2025-12-31T17:27:39.000Z"><meta property="article:tag" content="optimization"><meta property="article:tag" content="cpu-cache"><meta property="article:tag" content="performance"><meta property="article:tag" content="cpp"><meta property="article:modified_time" content="2025-12-31T17:27:39.000Z"><script async src="https://www.googletagmanager.com/gtag/js?id=G-6HX7S00F14"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-6HX7S00F14');</script><meta name="theme-color" content="#3eaf7c"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><title>C++ Performance Study — Using CPU Cache Properties | Dr. Vladimir Petukhov</title><meta name="description" content="C++ Performance Study: Use CPU Cache Properties Code on Github Introduction While learning how to work with images for computer vision, I was told to use a property of CPU cache...">
    <link rel="preload" href="/assets/style-CHm-93Be.css" as="style"><link rel="stylesheet" href="/assets/style-CHm-93Be.css">
    <link rel="modulepreload" href="/assets/app-DMvgv8AB.js"><link rel="modulepreload" href="/assets/cpp-performance-cache-study.html-CwcYnsQG.js">
    <link rel="prefetch" href="/assets/index.html-Cj_mW7g9.js" as="script"><link rel="prefetch" href="/assets/java-vector-field-widget.html-DrKA6Tg_.js" as="script"><link rel="prefetch" href="/assets/knowledge_base.html-Cw_kCrAP.js" as="script"><link rel="prefetch" href="/assets/readings.html-CbscqBCV.js" as="script"><link rel="prefetch" href="/assets/index.html-B0LnWRO5.js" as="script"><link rel="prefetch" href="/assets/state-machine-design-pattern.html-D1Sfr5v1.js" as="script"><link rel="prefetch" href="/assets/task-queue-design-pattern.html-Cl-rw3o9.js" as="script"><link rel="prefetch" href="/assets/index.html-CkHS_lVB.js" as="script"><link rel="prefetch" href="/assets/index.html-DqHa4iIA.js" as="script"><link rel="prefetch" href="/assets/index.html-1A67wlet.js" as="script"><link rel="prefetch" href="/assets/404.html-jc_d6_w8.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><!----><span class="vp-site-name" aria-hidden="true">Dr. Vladimir Petukhov</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="Home"><!--[--><!--[--><!--]--><!--]-->Home<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/Services/" aria-label="Services"><!--[--><!--[--><!--]--><!--]-->Services<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/Contact/" aria-label="Contact"><!--[--><!--[--><!--]--><!--]-->Contact<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/Resume/" aria-label="CV"><!--[--><!--[--><!--]--><!--]-->CV<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/Blog/" aria-label="Blog"><!--[--><!--[--><!--]--><!--]-->Blog<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/vperepos" aria-label="Github" rel="noopener noreferrer" target="_blank"><!--[--><!--[--><!--]--><!--]-->Github<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="Home"><!--[--><!--[--><!--]--><!--]-->Home<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/Services/" aria-label="Services"><!--[--><!--[--><!--]--><!--]-->Services<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/Contact/" aria-label="Contact"><!--[--><!--[--><!--]--><!--]-->Contact<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/Resume/" aria-label="CV"><!--[--><!--[--><!--]--><!--]-->CV<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/Blog/" aria-label="Blog"><!--[--><!--[--><!--]--><!--]-->Blog<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/vperepos" aria-label="Github" rel="noopener noreferrer" target="_blank"><!--[--><!--[--><!--]--><!--]-->Github<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><a class="route-link auto-link vp-sidebar-item vp-sidebar-heading" href="/Blog/state-machine-design-pattern.html" aria-label="State Machine Design Pattern in Modern C++"><!--[--><!--[--><!--]--><!--]-->State Machine Design Pattern in Modern C++<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item vp-sidebar-heading" href="/Blog/task-queue-design-pattern.html" aria-label="Task Queue Design Pattern in Modern C++"><!--[--><!--[--><!--]--><!--]-->Task Queue Design Pattern in Modern C++<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link route-link-active auto-link vp-sidebar-item vp-sidebar-heading active" href="/Blog/cpp-performance-cache-study.html" aria-label="C++ Performance Study — Using CPU Cache Properties"><!--[--><!--[--><!--]--><!--]-->C++ Performance Study — Using CPU Cache Properties<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item vp-sidebar-heading" href="/Blog/java-vector-field-widget.html" aria-label="Vector Field Widget in JavaFX"><!--[--><!--[--><!--]--><!--]-->Vector Field Widget in JavaFX<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item vp-sidebar-heading" href="/Blog/knowledge_base.html" aria-label="Knowledge Base"><!--[--><!--[--><!--]--><!--]-->Knowledge Base<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item vp-sidebar-heading" href="/Blog/readings.html" aria-label="Readings"><!--[--><!--[--><!--]--><!--]-->Readings<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div vp-content><!--[--><!--]--><div id="content"><h1 id="c-performance-study-use-cpu-cache-properties" tabindex="-1"><a class="header-anchor" href="#c-performance-study-use-cpu-cache-properties"><span>C++ Performance Study: Use CPU Cache Properties</span></a></h1><p><a href="https://github.com/VPERepos/CppPerformanceStudy_UseCPUCacheProperties/tree/main" target="_blank" rel="noopener noreferrer">Code on Github</a></p><h2 id="introduction" tabindex="-1"><a class="header-anchor" href="#introduction"><span>Introduction</span></a></h2><p>While learning how to work with images for computer vision, I was told to use a property of CPU cache in order to process two dimensional arrays in C++ faster. It means that accessing 2D arrays by rows in the inner loop is faster than by columns, due to the property of fast cache memory access, containing data lines. It is faster to get the whole line of data from the cache, than jumping from line to line. This small project compares 3 ways of containing 2D data in C++ (but the list is not complete only by these 3 types of data structures). The first considered data structure is a standard C++ dynamically allocated one dimensional array. The second is two dimensional C++ dynamically allocated array. And the last one is a vector of vectors from the standard C++ library.</p><h2 id="code-structure-and-behaviour" tabindex="-1"><a class="header-anchor" href="#code-structure-and-behaviour"><span>Code structure and behaviour</span></a></h2><p>Another interesting programming feature that I wanted to show in this project is code duplication avoidance by utliziation of polymorph classes. The initial git commit here consists of proof of consept and one can see that code that measures the execution time is duplicated for every data structure. That is why I decided to refactor the code resulting in introduction of the following classes. <img src="/assets/UseCacheClassDiagram-BZ1F-jcQ.svg" alt="UMLDiagram"> There is a parent class called Containers2d that has common functionality and variables and 3 specializing classes containing the described data structures. After refactoring the code that implements execution time measurements resides only in one place in the parent class. The functionality of the program is described by the following sequence diagram. The containers are initialized randomly and the program measures execution time of accessing each element calculating squared value and saving it in the initial container. This is done 1000 times in order to measure average execution time. <img src="/assets/UseCacheSequenceDiagram-BMooS7Ry.svg" alt="UMLDiagram"></p><h2 id="results-and-discussion" tabindex="-1"><a class="header-anchor" href="#results-and-discussion"><span>Results and discussion</span></a></h2><p>The results of several runs for different array sizes are presented in the file results.txt in the repository. Here some excerpt for an array 1000x1000 is presented in the table.</p><table><thead><tr><th style="text-align:left;"></th><th style="text-align:left;"></th><th style="text-align:left;"></th><th style="text-align:left;"></th></tr></thead><tbody><tr><td style="text-align:left;"><strong>Processing type</strong></td><td style="text-align:left;"><strong>Execution time (microseconds) Array1d</strong></td><td style="text-align:left;"><strong>Execution time (microseconds) Array2d</strong></td><td style="text-align:left;"><strong>Execution time (microseconds) Vector2d</strong></td></tr><tr><td style="text-align:left;">Processed by rows</td><td style="text-align:left;">2732.27</td><td style="text-align:left;">2622.73</td><td style="text-align:left;">7236.22</td></tr><tr><td style="text-align:left;">Processed by columns</td><td style="text-align:left;">3098.9</td><td style="text-align:left;">2879.58</td><td style="text-align:left;">7669.81</td></tr><tr><td style="text-align:left;">Ratio (%)</td><td style="text-align:left;">13</td><td style="text-align:left;">10</td><td style="text-align:left;">6</td></tr></tbody></table><p>One can see that the slowest container is STL vector - around 3 times slower than the fastest one - dynamic 2D array. But the biggest performance increase has the 1D dynamic array. The results range a little bit from experiment to experiment, but the tendency remains the same. There are only several weird measurements braking the tendency, but recompilation of the project eliminated the behaviour, when STL vector processing by columns was a lot faster than by rows (please see the results.txt in the repository).</p></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Last Updated: </span><time class="meta-item-info" datetime="2025-12-31T17:27:39.000Z" data-allow-mismatch>12/31/25, 6:27 PM</time></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: v.petukhov@mail.de">Vladimir Petukhov</span><!----><!--]--><!--]--></span></div></div></footer><nav class="vp-page-nav" aria-label="page navigation"><a class="route-link auto-link prev" href="/Blog/task-queue-design-pattern.html" aria-label="Task Queue Design Pattern in Modern C++"><!--[--><div class="hint"><span class="arrow left"></span> Prev</div><div class="link"><span class="external-link">Task Queue Design Pattern in Modern C++</span></div><!--]--></a><a class="route-link auto-link next" href="/Blog/java-vector-field-widget.html" aria-label="Vector Field Widget in JavaFX"><!--[--><div class="hint">Next <span class="arrow right"></span></div><div class="link"><span class="external-link">Vector Field Widget in JavaFX</span></div><!--]--></a></nav><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-DMvgv8AB.js" defer></script>
  </body>
</html>
